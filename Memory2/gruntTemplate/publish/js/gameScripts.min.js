function preload(){queue=new createjs.LoadQueue(!1),queue.addEventListener("complete",init),queue.loadManifest([{id:"shell",src:"img/card.png"},{id:"back",src:"img/back.png"},{id:"garlic",src:"img/garlic.png"},{id:"onion",src:"img/onion.png"},{id:"pepper",src:"img/pepper.png"},{id:"potato",src:"img/potato.png"},{id:"spinach",src:"img/spinach.png"},{id:"tomato",src:"img/tomato.png"}])}function init(){stage=new createjs.Stage(document.getElementById("canvas")),buildCards(),shuffleCards(),dealCards(),startGame()}function buildCards(){var a,b,c,d,e,f;for(a=0;a<faces.length;a++)b=new createjs.Container,d=new createjs.Bitmap(queue.getResult("shell")),b.regX=d.image.width/2,b.regY=d.image.height/2,b.addChild(d),f=faces[a],console.log("face: "+f),d=new createjs.Bitmap(queue.getResult(f)),d.regX=d.image.width/2,d.regY=d.image.height/2,d.x=b.regX,d.y=70,b.addChild(d),e=new createjs.Text(faces[a].toUpperCase(),"20px Arial","#FFF"),e.textAlign="center",e.x=b.regX,e.y=144,b.addChild(e),d=new createjs.Bitmap(queue.getResult("back")),d.name="back",b.addChild(d),c=b.clone(!0),b.name=c.name=faces[a],b.key=c.key=faces[a],cards.push(b,c)}function shuffleCards(){var a,b,c=cards.length,d=[];for(a=0;c>a;a++)b=Math.floor(Math.random()*cards.length),d.push(cards[b]),cards.splice(b,1);cards=cards.concat(d)}function dealCards(){console.log("dealCards");var a,b,c=100,d=100,e=0;for(a=0;a<cards.length;a++)b=cards[a],console.log("card.key: "+b.key),console.log("card: "+b),b.x=-200,b.y=400,b.rotation=600*Math.random(),b.addEventListener("click",flipCard),stage.addChild(b),createjs.Tween.get(b).wait(100*a).to({x:c,y:d,rotation:0},300),c+=150,e++,4===e&&(e=0,c=100,d+=220)}function flipCard(a){if(console.log("flip card"),2!==cardsFlipped){var b=a.target.parent;console.log("e.target: "+a.target),b.mouseEnabled=!1,b.visible=!1,cardsFlipped.push(b),2===cardsFlipped.length&&evalCardsFlipped()}}function evalCardsFlipped(){console.log("evalCardsFlipped"),console.log("cardsFlipped[0].key: "+cardsFlipped[0].key),console.log("cardsFlipped[1].key: "+cardsFlipped[1].key),cardsFlipped[0].key===cardsFlipped[1].key?(matches++,evalGame()):setTimeout(resetFlippedCards,1e3)}function resetFlippedCards(){console.log("resetFlippedCards"),cardsFlipped[0].mouseEnabled=cardsFlipped[1].mouseEnabled=1,cardsFlipped[0].visible=!0,cardsFlipped[1].visible=!0,cardsFlipped=[]}function evalGame(){console.log("evalGame"),matches===faces.length?setTimeout(function(){alert("You Win!")},300):cardsFlipped=[]}function startGame(){console.log("startGame"),createjs.Ticker.setFPS(60),createjs.Ticker.addEventListener("tick",function(){stage.update()})}var stage,queue,faces=["garlic","onion","pepper","potato","spinach","tomato"],cards=[],cardsFlipped=[],matches=0;